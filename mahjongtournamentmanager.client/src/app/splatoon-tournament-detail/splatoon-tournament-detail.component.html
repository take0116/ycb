<div *ngIf="tournament" class="tournament-detail-container">
  <h2>{{ tournament.tournamentName }}</h2>

  <div class="detail-section">
    <h3>開催情報</h3>
    <p><strong>開催日:</strong> {{ tournament.eventDate | date:'yyyy/MM/dd' }}</p>
    <p><strong>時間:</strong> {{ tournament.startTime | slice:0:5 }} - {{ tournament.endTime | slice:0:5 }}</p>
    <p><strong>状態:</strong> {{ tournament.status === 0 ? '企画中' : (tournament.status === 1 ? '募集中' : (tournament.status === 2 ? '募集終了' : '終了')) }}</p>
  </div>

  <div class="detail-section">
    <h3>ルール</h3>
    <p><strong>ゲームモード:</strong> {{ tournament.gameMode }}</p>
    <p><strong>ステージ選択:</strong> {{ tournament.stageSelection }}</p>
    <p><strong>ブキ制限:</strong> {{ tournament.weaponRestriction || 'なし' }}</p>
    <p><strong>ギア制限:</strong> {{ tournament.gearRestriction || 'なし' }}</p>
  </div>

  <div class="detail-section" *ngIf="tournament.comment">
    <h3>コメント</h3>
    <p>{{ tournament.comment }}</p>
  </div>

  <div class="action-section">
    <div>
      <button *ngIf="!isParticipating" (click)="joinTournament()" class="join-button">参加する</button>
    </div>
    <button *ngIf="authService.hasRole('Admin')" (click)="editTournament()" class="edit-button">編集</button>
    <button *ngIf="authService.hasRole('Admin')" (click)="deleteTournament()" class="delete-button">イベントを削除</button>
  </div>

  <div class="detail-section" *ngIf="isParticipating && authService.hasRole('Admin')">
    <h3>参加者一覧</h3>
    <table class="participants-table" *ngIf="participants.length > 0; else noParticipants">
      <thead>
        <tr>
          <th>参加者名</th>
          <th>登録日時</th>
          <th *ngIf="authService.hasRole('Admin')" class="actions-column">操作</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let participant of participants">
          <td>{{ participant.user.userName }}</td>
          <td>{{ participant.joinedDate | date:'yyyy/MM/dd HH:mm:ss' }}</td>
          <td *ngIf="authService.hasRole('Admin')" class="actions-column">
            <button (click)="removeParticipant(participant.userId)" class="remove-participant-button">参加を取り消す</button>
          </td>
        </tr>
      </tbody>
    </table>
    <ng-template #noParticipants>
      <p>まだ参加者はいません。</p>
    </ng-template>
  </div>

</div>

<div *ngIf="!tournament && !message" class="loading-message">
  <p>大会情報を読み込み中...</p>
</div>

<div *ngIf="!tournament && message" class="error-message">
  <p>{{ message }}</p>
</div>
